<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Pandas 分组操作">

<title>learn-data-analysis - Pandas Part2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="learn-data-analysis - Pandas Part2">
<meta property="og:description" content="Pandas 分组操作">
<meta property="og:site-name" content="learn-data-analysis">
<meta name="twitter:title" content="learn-data-analysis - Pandas Part2">
<meta name="twitter:description" content="Pandas 分组操作">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">learn-data-analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Overview</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pymjer/learn-data-analysis" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../pandas/index.html">Pandas</a></li><li class="breadcrumb-item"><a href="../pandas/part2_applied_pandas.html">Pandas Part2</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Pandas</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas Index</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/part1_core_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas Part1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/part2_applied_pandas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Pandas Part2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pandas/part3_func_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pandas Part3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../matplot_demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matplot</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../seaborn_demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Seaborn</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../plotly_demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotly</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../sklearn_demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scikit-Learn</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../pytorch_demo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PyTorch</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../fastai_core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fastai Core</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#multiindex-dataframes" id="toc-multiindex-dataframes" class="nav-link active" data-scroll-target="#multiindex-dataframes">7 MultiIndex DataFrames</a>
  <ul class="collapse">
  <li><a href="#selecting-with-a-multiindex" id="toc-selecting-with-a-multiindex" class="nav-link" data-scroll-target="#selecting-with-a-multiindex">Selecting with a MultiIndex</a></li>
  </ul></li>
  <li><a href="#reshaping-and-pivoting" id="toc-reshaping-and-pivoting" class="nav-link" data-scroll-target="#reshaping-and-pivoting">8 Reshaping And Pivoting</a></li>
  <li><a href="#the-groupby-object" id="toc-the-groupby-object" class="nav-link" data-scroll-target="#the-groupby-object">9 The GroupBy Object</a>
  <ul class="collapse">
  <li><a href="#creating-a-groupby-object-from-scratch" id="toc-creating-a-groupby-object-from-scratch" class="nav-link" data-scroll-target="#creating-a-groupby-object-from-scratch">9.1 Creating a GroupBy Object from Scratch</a></li>
  <li><a href="#creating-a-groupby-object-from-a-dataset" id="toc-creating-a-groupby-object-from-a-dataset" class="nav-link" data-scroll-target="#creating-a-groupby-object-from-a-dataset">9.2 Creating a GroupBy Object from a Dataset</a></li>
  <li><a href="#attributes-and-methods-of-a-groupby-object" id="toc-attributes-and-methods-of-a-groupby-object" class="nav-link" data-scroll-target="#attributes-and-methods-of-a-groupby-object">9.3 Attributes and methods of a GroupBy object</a></li>
  <li><a href="#aggregate-operations" id="toc-aggregate-operations" class="nav-link" data-scroll-target="#aggregate-operations">9.4 Aggregate operations</a></li>
  <li><a href="#applying-a-custom-operation-to-all-groups" id="toc-applying-a-custom-operation-to-all-groups" class="nav-link" data-scroll-target="#applying-a-custom-operation-to-all-groups">9.5 Applying a custom operation to all groups</a></li>
  <li><a href="#grouping-by-multiple-columns" id="toc-grouping-by-multiple-columns" class="nav-link" data-scroll-target="#grouping-by-multiple-columns">9.6 Grouping by multiple columns</a></li>
  <li><a href="#coding-challenge" id="toc-coding-challenge" class="nav-link" data-scroll-target="#coding-challenge">9.7 Coding challenge</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/pymjer/learn-data-analysis/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Pandas Part2</h1>
</div>

<div>
  <div class="description">
    Pandas 分组操作
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas._testing <span class="im">as</span> tm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>BASE <span class="op">=</span> Path(<span class="st">'../../input/'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="multiindex-dataframes" class="level1">
<h1>7 MultiIndex DataFrames</h1>
<p>这一章包含如下内容 * 创建一个MultiIndex * 从一个MultiIndex 的DataFrame中选择rows和coumns * 从 MultiIndex DataFrame 中提取截面数据 * 切换 MultiIndex 级别</p>
<p>维数是我们从数据结构中提取值所需的参考点数,我们从Series中提取数据时只需要一个label，我们从DataFrame中提取值需要两个label。 当我们需要更多维数时，就需要MultiIndex</p>
<p><code>MultiIndex</code>是一个包含多个级别的index的对象</p>
<p>多级索引MultiIndex的使用</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>addresses <span class="op">=</span> [</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"8809 Flair Square"</span>, <span class="st">"Toddside"</span>, <span class="st">"IL"</span>, <span class="st">"37206"</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"9901 Austin Street"</span>, <span class="st">"Toddside"</span>, <span class="st">"IL"</span>, <span class="st">"37206"</span>),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>            (<span class="st">"905 Hogan Quarter"</span>, <span class="st">"Franklin"</span>, <span class="st">"IL"</span>, <span class="st">"37206"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>row_index <span class="op">=</span> pd.MultiIndex.from_tuples(tuples <span class="op">=</span> addresses, names<span class="op">=</span>[<span class="st">"Street"</span>, <span class="st">"City"</span>, <span class="st">"State"</span>, <span class="st">"Zip"</span>])</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>row_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MultiIndex([( '8809 Flair Square', 'Toddside', 'IL', '37206'),
            ('9901 Austin Street', 'Toddside', 'IL', '37206'),
            ( '905 Hogan Quarter', 'Franklin', 'IL', '37206')],
           names=['Street', 'City', 'State', 'Zip'])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"A"</span>, <span class="st">"B+"</span>],</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"C+"</span>, <span class="st">"C"</span>],</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"D-"</span>, <span class="st">"A"</span>],</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> [<span class="st">"Schools"</span>, <span class="st">"Cost of Living"</span>]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>area_grades <span class="op">=</span> pd.DataFrame(data<span class="op">=</span>data, index<span class="op">=</span>row_index, columns<span class="op">=</span>columns)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>area_grades</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Schools</th>
<th data-quarto-table-cell-role="th">Cost of Living</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">Zip</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8809 Flair Square</td>
<td data-quarto-table-cell-role="th">Toddside</td>
<td data-quarto-table-cell-role="th">IL</td>
<td data-quarto-table-cell-role="th">37206</td>
<td>A</td>
<td>B+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9901 Austin Street</td>
<td data-quarto-table-cell-role="th">Toddside</td>
<td data-quarto-table-cell-role="th">IL</td>
<td data-quarto-table-cell-role="th">37206</td>
<td>C+</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">905 Hogan Quarter</td>
<td data-quarto-table-cell-role="th">Franklin</td>
<td data-quarto-table-cell-role="th">IL</td>
<td data-quarto-table-cell-role="th">37206</td>
<td>D-</td>
<td>A</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>上面的示例我们把MultiIndex放在行轴中。我们也可以放在列轴，Pandas也将DataFrame的列标题存储在索引对象中。我们可以通过columns属性访问该索引</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>area_grades.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['Schools', 'Cost of Living'], dtype='object')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>column_index <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>             [</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                 (<span class="st">"Culture"</span>, <span class="st">"Restaurants"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                 (<span class="st">"Culture"</span>, <span class="st">"Museums"</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                 (<span class="st">"Services"</span>, <span class="st">"Police"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                 (<span class="st">"Services"</span>, <span class="st">"Schools"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>             ]</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>column_index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MultiIndex([( 'Culture', 'Restaurants'),
            ( 'Culture',     'Museums'),
            ('Services',      'Police'),
            ('Services',     'Schools')],
           )</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"C-"</span>, <span class="st">"B+"</span>, <span class="st">"B-"</span>, <span class="st">"A"</span>],</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"D+"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"C+"</span>],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>            [<span class="st">"A-"</span>, <span class="st">"A"</span>, <span class="st">"D+"</span>, <span class="st">"F"</span>]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>             data <span class="op">=</span> data, index <span class="op">=</span> row_index, columns <span class="op">=</span> column_index</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">Zip</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">8809 Flair Square</td>
<td data-quarto-table-cell-role="th">Toddside</td>
<td data-quarto-table-cell-role="th">IL</td>
<td data-quarto-table-cell-role="th">37206</td>
<td>C-</td>
<td>B+</td>
<td>B-</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9901 Austin Street</td>
<td data-quarto-table-cell-role="th">Toddside</td>
<td data-quarto-table-cell-role="th">IL</td>
<td data-quarto-table-cell-role="th">37206</td>
<td>D+</td>
<td>C</td>
<td>A</td>
<td>C+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">905 Hogan Quarter</td>
<td data-quarto-table-cell-role="th">Franklin</td>
<td data-quarto-table-cell-role="th">IL</td>
<td data-quarto-table-cell-role="th">37206</td>
<td>A-</td>
<td>A</td>
<td>D+</td>
<td>F</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>neighborhoods <span class="op">=</span> pd.read_csv(BASE <span class="op">/</span> <span class="st">"neighbor/neighborhoods.csv"</span>, index_col<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>], header<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>neighborhoods</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">MO2</td>
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">Fisherborough4</td>
<td data-quarto-table-cell-role="th">249 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">250 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">251 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">252 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A—</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AR</td>
<td data-quarto-table-cell-role="th">Allisonland 124</td>
<td data-quarto-table-cell-role="th">Diaz Brooks</td>
<td>C-</td>
<td>A+</td>
<td>F</td>
<td>C+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GA</td>
<td data-quarto-table-cell-role="th">Amyburgh 941</td>
<td data-quarto-table-cell-role="th">Brian Ex</td>
<td>B</td>
<td>B</td>
<td>D-</td>
<td>C+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IA</td>
<td data-quarto-table-cell-role="th">Amyburgh 163</td>
<td data-quarto-table-cell-role="th">Heather</td>
<td>F</td>
<td>D</td>
<td>A+</td>
<td>A-</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
MultiIndex: 12 entries, ('MO1', 'Fisherborough3', '244 Tracy View') to ('IA', 'Amyburgh 163', 'Heather')
Data columns (total 4 columns):
 #   Column                  Non-Null Count  Dtype 
---  ------                  --------------  ----- 
 0   (Culture, Restaurants)  12 non-null     object
 1   (Culture, Museums)      12 non-null     object
 2   (Services, Police)      12 non-null     object
 3   (Services, Schools)     12 non-null     object
dtypes: object(4)
memory usage: 1.4+ KB</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.index.names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>FrozenList(['State', 'City', 'Street'])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.index.get_level_values(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['244 Tracy View', '245 Tracy View', '246 Tracy View', '247 Tracy View',
       '248 Tracy View', '249 Tracy View', '250 Tracy View', '251 Tracy View',
       '252 Tracy View', 'Diaz Brooks', 'Brian Ex', 'Heather'],
      dtype='object', name='Street')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.columns.names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>FrozenList([None, None])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.columns.names <span class="op">=</span> [<span class="st">"Category"</span>, <span class="st">"Subcategory"</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>neighborhoods.columns.names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>FrozenList(['Category', 'Subcategory'])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.columns.get_level_values(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['Culture', 'Culture', 'Services', 'Services'], dtype='object', name='Category')</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.sort_index(ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AR</td>
<td data-quarto-table-cell-role="th">Allisonland 124</td>
<td data-quarto-table-cell-role="th">Diaz Brooks</td>
<td>C-</td>
<td>A+</td>
<td>F</td>
<td>C+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">GA</td>
<td data-quarto-table-cell-role="th">Amyburgh 941</td>
<td data-quarto-table-cell-role="th">Brian Ex</td>
<td>B</td>
<td>B</td>
<td>D-</td>
<td>C+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">IA</td>
<td data-quarto-table-cell-role="th">Amyburgh 163</td>
<td data-quarto-table-cell-role="th">Heather</td>
<td>F</td>
<td>D</td>
<td>A+</td>
<td>A-</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.sort_index(level<span class="op">=</span><span class="dv">0</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">AR</td>
<td data-quarto-table-cell-role="th">Allisonland 124</td>
<td data-quarto-table-cell-role="th">Diaz Brooks</td>
<td>C-</td>
<td>A+</td>
<td>F</td>
<td>C+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">GA</td>
<td data-quarto-table-cell-role="th">Amyburgh 941</td>
<td data-quarto-table-cell-role="th">Brian Ex</td>
<td>B</td>
<td>B</td>
<td>D-</td>
<td>C+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">IA</td>
<td data-quarto-table-cell-role="th">Amyburgh 163</td>
<td data-quarto-table-cell-role="th">Heather</td>
<td>F</td>
<td>D</td>
<td>A+</td>
<td>A-</td>
</tr>
<tr class="even">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建一个包含多级索引的数据框</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'销售额'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">150</span>, <span class="dv">250</span>, <span class="dv">300</span>, <span class="dv">350</span>],</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'销售量'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>]}</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> pd.MultiIndex.from_tuples([(<span class="st">'东区'</span>, <span class="st">'苹果'</span>), (<span class="st">'东区'</span>, <span class="st">'梨子'</span>), (<span class="st">'东区'</span>, <span class="st">'香蕉'</span>),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                   (<span class="st">'西区'</span>, <span class="st">'苹果'</span>), (<span class="st">'西区'</span>, <span class="st">'梨子'</span>), (<span class="st">'西区'</span>, <span class="st">'香蕉'</span>)],</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>                                  names<span class="op">=</span>[<span class="st">'区域'</span>, <span class="st">'产品'</span>])</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>index)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       销售额  销售量
区域 产品          
东区 苹果  100   10
   梨子  200   20
   香蕉  150   15
西区 苹果  250   25
   梨子  300   30
   香蕉  350   35</code></pre>
</div>
</div>
<section id="selecting-with-a-multiindex" class="level2">
<h2 class="anchored" data-anchor-id="selecting-with-a-multiindex">Selecting with a MultiIndex</h2>
<p>使用tuple来选择特定的列</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>neighborhoods[<span class="st">'Services'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">MO2</td>
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">Fisherborough4</td>
<td data-quarto-table-cell-role="th">249 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">250 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">251 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">252 Tracy View</td>
<td>D-</td>
<td>A—</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AR</td>
<td data-quarto-table-cell-role="th">Allisonland 124</td>
<td data-quarto-table-cell-role="th">Diaz Brooks</td>
<td>F</td>
<td>C+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GA</td>
<td data-quarto-table-cell-role="th">Amyburgh 941</td>
<td data-quarto-table-cell-role="th">Brian Ex</td>
<td>D-</td>
<td>C+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IA</td>
<td data-quarto-table-cell-role="th">Amyburgh 163</td>
<td data-quarto-table-cell-role="th">Heather</td>
<td>A+</td>
<td>A-</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>neighborhoods[(<span class="st">'Services'</span>, <span class="st">"Schools"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>State  City             Street        
MO1    Fisherborough3   244 Tracy View    A+
                        245 Tracy View    A+
                        246 Tracy View    A+
                        247 Tracy View    A+
                        248 Tracy View    A+
MO2    Fisherborough4   249 Tracy View    A+
                        250 Tracy View    A+
                        251 Tracy View    A+
                        252 Tracy View    A—
AR     Allisonland 124  Diaz Brooks       C+
GA     Amyburgh 941     Brian Ex          C+
IA     Amyburgh 163     Heather           A-
Name: (Services, Schools), dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>neighborhoods[[(<span class="st">'Services'</span>, <span class="st">"Schools"</span>), (<span class="st">"Culture"</span>, <span class="st">"Museums"</span>)]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Category</th>
<th data-quarto-table-cell-role="th">Services</th>
<th data-quarto-table-cell-role="th">Culture</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Schools</th>
<th data-quarto-table-cell-role="th">Museums</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="even">
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">MO2</td>
<td rowspan="4" data-quarto-table-cell-role="th" data-valign="top">Fisherborough4</td>
<td data-quarto-table-cell-role="th">249 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">250 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">251 Tracy View</td>
<td>A+</td>
<td>F</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">252 Tracy View</td>
<td>A—</td>
<td>F</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">AR</td>
<td data-quarto-table-cell-role="th">Allisonland 124</td>
<td data-quarto-table-cell-role="th">Diaz Brooks</td>
<td>C+</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GA</td>
<td data-quarto-table-cell-role="th">Amyburgh 941</td>
<td data-quarto-table-cell-role="th">Brian Ex</td>
<td>C+</td>
<td>B</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">IA</td>
<td data-quarto-table-cell-role="th">Amyburgh 163</td>
<td data-quarto-table-cell-role="th">Heather</td>
<td>A-</td>
<td>D</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.loc[<span class="st">"MO1"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.loc[<span class="st">"MO2"</span>, <span class="st">"Fisherborough4"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/5s/hp2lrr6s28dcft7pjdnx9w3c0000gn/T/ipykernel_53050/1088001906.py:1: PerformanceWarning: indexing past lexsort depth may impact performance.
  neighborhoods.loc["MO2", "Fisherborough4"]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">249 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">250 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">251 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">252 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A—</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.loc[(<span class="st">"MO2"</span>, <span class="st">"Fisherborough4"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/5s/hp2lrr6s28dcft7pjdnx9w3c0000gn/T/ipykernel_53050/3316804197.py:1: PerformanceWarning: indexing past lexsort depth may impact performance.
  neighborhoods.loc[("MO2", "Fisherborough4")]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">249 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">250 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">251 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">252 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A—</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.loc[(<span class="st">"MO1"</span>,<span class="st">"Fisherborough3"</span>, <span class="st">"244 Tracy View"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Category  Subcategory
Culture   Restaurants    A+
          Museums         A
Services  Police         A-
          Schools        A+
Name: (MO1, Fisherborough3, 244 Tracy View), dtype: object</code></pre>
</div>
</div>
<p>定位到具体的列</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.iloc[<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Category</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Culture</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">Services</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Restaurants</th>
<th data-quarto-table-cell-role="th">Museums</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="header">
<th data-quarto-table-cell-role="th">State</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">MO1</td>
<td rowspan="2" data-quarto-table-cell-role="th" data-valign="top">Fisherborough3</td>
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A+</td>
<td>A</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>C+</td>
<td>F</td>
<td>D-</td>
<td>A+</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>neighborhoods.loc[(<span class="st">"MO1"</span>,<span class="st">"Fisherborough3"</span>), (<span class="st">"Services"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/5s/hp2lrr6s28dcft7pjdnx9w3c0000gn/T/ipykernel_53050/1488621064.py:1: PerformanceWarning: indexing past lexsort depth may impact performance.
  neighborhoods.loc[("MO1","Fisherborough3"), ("Services")]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Subcategory</th>
<th data-quarto-table-cell-role="th">Police</th>
<th data-quarto-table-cell-role="th">Schools</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Street</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">244 Tracy View</td>
<td>A-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248 Tracy View</td>
<td>D-</td>
<td>A+</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="reshaping-and-pivoting" class="level1">
<h1>8 Reshaping And Pivoting</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> unpivot(frame):</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    N, K <span class="op">=</span> frame.shape</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> {</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"value"</span>: frame.to_numpy().ravel(<span class="st">"F"</span>),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"variable"</span>: np.asarray(frame.columns).repeat(N),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"date"</span>: np.tile(np.asarray(frame.index), K),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">"date"</span>, <span class="st">"variable"</span>, <span class="st">"value"</span>])</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> unpivot(tm.makeTimeDataFrame(<span class="dv">3</span>))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-03</td>
<td>A</td>
<td>-0.768358</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-04</td>
<td>A</td>
<td>1.330403</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-05</td>
<td>A</td>
<td>0.276373</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-03</td>
<td>B</td>
<td>-0.376606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-04</td>
<td>B</td>
<td>0.754802</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2000-01-05</td>
<td>B</td>
<td>2.284716</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2000-01-03</td>
<td>C</td>
<td>2.190118</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2000-01-04</td>
<td>C</td>
<td>1.372167</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2000-01-05</td>
<td>C</td>
<td>0.667245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2000-01-03</td>
<td>D</td>
<td>0.061336</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2000-01-04</td>
<td>D</td>
<td>-0.386002</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2000-01-05</td>
<td>D</td>
<td>-1.083017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>在上面的代码中，<code>tm.makeTimeDataFrame(3)</code>是pandas中的一个函数，用于生成一个具有时间索引（行）和多个随机数列（列）的DataFrame。<code>frame.to_numpy()</code>将这个DataFrame转换为一个NumPy数组，然后使用<code>ravel("F")</code>方法将数组展平为一维，并按列（“F”代表列优先）排列。</p>
<p><code>ravel()</code>方法是NumPy中的一个函数，用于将多维数组展平为一维数组。在这里，使用<code>ravel("F")</code>方法将二维数组按列优先展平为一维数组。具体来说，它将DataFrame中每一列的值排列在一起，形成一个一维的NumPy数组。</p>
<p>这种展平操作通常用于将多维数组转换为一维数组，以便更容易地进行操作和计算。在这个例子中，将DataFrame展平为一维数组，可以方便地在数组上执行各种NumPy函数和操作。例如，可以使用<code>np.mean()</code>函数计算数组的平均值，使用<code>np.max()</code>函数计算数组中的最大值等等。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> tm.makeTimeDataFrame(<span class="dv">3</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03</td>
<td>-3.162911</td>
<td>-1.006925</td>
<td>-1.249653</td>
<td>1.030808</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-04</td>
<td>0.365358</td>
<td>-0.658205</td>
<td>-0.253618</td>
<td>0.073849</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05</td>
<td>-0.217306</td>
<td>0.160332</td>
<td>0.290791</td>
<td>-2.597053</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> tm.makeTimeDataFrame(<span class="dv">3</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>frame.to_numpy().ravel(<span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array([-0.31664893, -0.46218133, -0.78354049,  1.10189489,  0.58325747,
       -0.58195594,  0.81975822,  0.40629766, -1.60102402,  0.34026248,
        0.64600556,  0.23418127])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pivoted <span class="op">=</span> df.pivot(index<span class="op">=</span><span class="st">'date'</span>, columns<span class="op">=</span><span class="st">'variable'</span>, values<span class="op">=</span><span class="st">'value'</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pivoted</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-03</td>
<td>-0.768358</td>
<td>-0.376606</td>
<td>2.190118</td>
<td>0.061336</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2000-01-04</td>
<td>1.330403</td>
<td>0.754802</td>
<td>1.372167</td>
<td>-0.386002</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000-01-05</td>
<td>0.276373</td>
<td>2.284716</td>
<td>0.667245</td>
<td>-1.083017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pivoted.reset_index().melt(id_vars<span class="op">=</span><span class="st">'date'</span>, var_name<span class="op">=</span><span class="st">'type'</span>, value_name<span class="op">=</span><span class="st">'value'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2000-01-03</td>
<td>A</td>
<td>-0.768358</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2000-01-04</td>
<td>A</td>
<td>1.330403</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2000-01-05</td>
<td>A</td>
<td>0.276373</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2000-01-03</td>
<td>B</td>
<td>-0.376606</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2000-01-04</td>
<td>B</td>
<td>0.754802</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2000-01-05</td>
<td>B</td>
<td>2.284716</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2000-01-03</td>
<td>C</td>
<td>2.190118</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2000-01-04</td>
<td>C</td>
<td>1.372167</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2000-01-05</td>
<td>C</td>
<td>0.667245</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2000-01-03</td>
<td>D</td>
<td>0.061336</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2000-01-04</td>
<td>D</td>
<td>-0.386002</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2000-01-05</td>
<td>D</td>
<td>-1.083017</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="the-groupby-object" class="level1">
<h1>9 The GroupBy Object</h1>
<p>本章包含如下内容 * 使用grouopby方法切分DataFrame * 在GroupBy对象中获取第一行和最后一行 * 执行聚合操作 * 遍历GroupBy对象中的DataFrames</p>
<p>pandas库的GroupBy对象是一个存储容器，用于将DataFrame的行分组到Buckets桶中.它提供了一组方法来聚合和分析集合中的每个独立组</p>
<section id="creating-a-groupby-object-from-scratch" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-groupby-object-from-scratch">9.1 Creating a GroupBy Object from Scratch</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>food_data <span class="op">=</span> {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Item"</span>: [<span class="st">"Banana"</span>, <span class="st">"Cucumber"</span>, <span class="st">"Orange"</span>, <span class="st">"Tomato"</span>, <span class="st">"Watermelon"</span>],</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Type"</span>: [<span class="st">"Fruit"</span>, <span class="st">"Vegetable"</span>, <span class="st">"Fruit"</span>, <span class="st">"Vegetable"</span>, <span class="st">"Fruit"</span>],</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">"Price"</span>: [<span class="fl">0.99</span>, <span class="fl">1.25</span>, <span class="fl">0.25</span>, <span class="fl">0.33</span>, <span class="fl">3.00</span>]</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>supermarket <span class="op">=</span> pd.DataFrame(data <span class="op">=</span> food_data)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>supermarket</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Item</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Banana</td>
<td>Fruit</td>
<td>0.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Cucumber</td>
<td>Vegetable</td>
<td>1.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Orange</td>
<td>Fruit</td>
<td>0.25</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Tomato</td>
<td>Vegetable</td>
<td>0.33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Watermelon</td>
<td>Fruit</td>
<td>3.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pd.get_dummies(supermarket.Type, prefix<span class="op">=</span><span class="st">"Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Type_Fruit</th>
<th data-quarto-table-cell-role="th">Type_Vegetable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>groups <span class="op">=</span> supermarket.groupby(<span class="st">"Type"</span>) </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>groups.get_group(<span class="st">"Fruit"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Item</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Banana</td>
<td>Fruit</td>
<td>0.99</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Orange</td>
<td>Fruit</td>
<td>0.25</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Watermelon</td>
<td>Fruit</td>
<td>3.00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>groups.Price.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Type
Fruit        1.413333
Vegetable    0.790000
Name: Price, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform 会返回一个和原始DataFrame结构相同的对象，每个对象的值还是和分组计算的值相同</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>groups.Price.transform(<span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0    1.413333
1    0.790000
2    1.413333
3    0.790000
4    1.413333
Name: Price, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="creating-a-groupby-object-from-a-dataset" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-groupby-object-from-a-dataset">9.2 Creating a GroupBy Object from a Dataset</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>fortune <span class="op">=</span> pd.read_csv(BASE <span class="op">/</span> <span class="st">"pandas-in-action/fortune1000.csv"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>fortune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Walmart</td>
<td>500343.0</td>
<td>9862.0</td>
<td>2300000</td>
<td>Retailing</td>
<td>General Merchandisers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Exxon Mobil</td>
<td>244363.0</td>
<td>19710.0</td>
<td>71200</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Berkshire Hathaway</td>
<td>242137.0</td>
<td>44940.0</td>
<td>377000</td>
<td>Financials</td>
<td>Insurance: Property and Casualty (Stock)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Apple</td>
<td>229234.0</td>
<td>48351.0</td>
<td>123000</td>
<td>Technology</td>
<td>Computers, Office Equipment</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UnitedHealth Group</td>
<td>201159.0</td>
<td>10558.0</td>
<td>260000</td>
<td>Health Care</td>
<td>Health Care: Insurance and Managed Care</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">995</td>
<td>SiteOne Landscape Supply</td>
<td>1862.0</td>
<td>54.6</td>
<td>3664</td>
<td>Wholesalers</td>
<td>Wholesalers: Diversified</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">996</td>
<td>Charles River Laboratories Intl</td>
<td>1858.0</td>
<td>123.4</td>
<td>11800</td>
<td>Health Care</td>
<td>Health Care: Pharmacy and Other Services</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">997</td>
<td>CoreLogic</td>
<td>1851.0</td>
<td>152.2</td>
<td>5900</td>
<td>Business Services</td>
<td>Financial Data Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">998</td>
<td>Ensign Group</td>
<td>1849.0</td>
<td>40.5</td>
<td>21301</td>
<td>Health Care</td>
<td>Health Care: Medical Facilities</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999</td>
<td>HCP</td>
<td>1848.0</td>
<td>414.2</td>
<td>190</td>
<td>Financials</td>
<td>Real estate</td>
</tr>
</tbody>
</table>

<p>1000 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>in_retailing <span class="op">=</span> fortune.Sector <span class="op">==</span> <span class="st">"Retailing"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>retail_companies <span class="op">=</span> fortune[in_retailing]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>retail_companies.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Walmart</td>
<td>500343.0</td>
<td>9862.0</td>
<td>2300000</td>
<td>Retailing</td>
<td>General Merchandisers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Amazon.com</td>
<td>177866.0</td>
<td>3033.0</td>
<td>566000</td>
<td>Retailing</td>
<td>Internet Services and Retailing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Costco</td>
<td>129025.0</td>
<td>2679.0</td>
<td>182000</td>
<td>Retailing</td>
<td>General Merchandisers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22</td>
<td>Home Depot</td>
<td>100904.0</td>
<td>8630.0</td>
<td>413000</td>
<td>Retailing</td>
<td>Specialty Retailers: Other</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>Target</td>
<td>71879.0</td>
<td>2934.0</td>
<td>345000</td>
<td>Retailing</td>
<td>General Merchandisers</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>retail_companies.Revenues.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>21874.714285714286</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>sectors <span class="op">=</span> fortune.groupby(<span class="st">"Sector"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>sectors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;pandas.core.groupby.generic.DataFrameGroupBy object&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(sectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>21</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看每个分组的数量，按字母表排序</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>sectors.size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Sector
Aerospace &amp; Defense               25
Apparel                           14
Business Services                 53
Chemicals                         33
Energy                           107
Engineering &amp; Construction        27
Financials                       155
Food &amp;  Drug Stores               12
Food, Beverages &amp; Tobacco         37
Health Care                       71
Hotels, Restaurants &amp; Leisure     26
Household Products                28
Industrials                       49
Materials                         45
Media                             25
Motor Vehicles &amp; Parts            19
Retailing                         77
Technology                       103
Telecommunications                10
Transportation                    40
Wholesalers                       44
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="attributes-and-methods-of-a-groupby-object" class="level2">
<h2 class="anchored" data-anchor-id="attributes-and-methods-of-a-groupby-object">9.3 Attributes and methods of a GroupBy object</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 本质上，GroupBy对象是一个字典，存储了每个分组的索引label</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>sectors.groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'Aerospace &amp; Defense': [26, 50, 58, 98, 117, 118, 207, 224, 275, 380, 404, 406, 414, 540, 660, 661, 806, 829, 884, 930, 954, 955, 959, 975, 988], 'Apparel': [88, 241, 331, 420, 432, 526, 529, 554, 587, 678, 766, 774, 835, 861], 'Business Services': [142, 160, 187, 199, 201, 221, 235, 242, 253, 295, 325, 358, 364, 423, 462, 465, 486, 493, 497, 499, 502, 510, 528, 567, 577, 584, 591, 599, 604, 618, 649, 686, 691, 692, 700, 702, 712, 720, 738, 744, 771, 802, 810, 825, 879, 888, 894, 895, 898, 905, 922, 972, 997], 'Chemicals': [46, 189, 190, 198, 214, 263, 281, 309, 344, 351, 381, 447, 450, 454, 527, 593, 623, 648, 671, 672, 679, 704, 722, 740, 790, 836, 865, 872, 908, 932, 958, 963, 978], 'Energy': [1, 12, 27, 30, 40, 63, 89, 90, 91, 94, 104, 114, 124, 125, 134, 145, 166, 167, 175, 184, 205, 212, 213, 217, 218, 219, 222, 231, 232, 243, 248, 254, 256, 265, 268, 269, 270, 273, 307, 313, 326, 333, 335, 343, 352, 363, 371, 379, 383, 384, 387, 428, 437, 452, 456, 488, 490, 496, 498, 500, 517, 534, 537, 559, 563, 582, 603, 617, 635, 638, 639, 647, 653, 668, 681, 682, 689, 708, 719, 723, 739, 768, 791, 798, 805, 812, 816, 818, 820, 826, 844, 859, 860, 866, 869, 885, 890, 901, 917, 934, ...], 'Engineering &amp; Construction': [152, 163, 210, 229, 296, 315, 338, 340, 367, 427, 443, 479, 541, 569, 588, 615, 705, 736, 737, 764, 779, 815, 841, 852, 962, 982, 986], 'Financials': [2, 19, 20, 23, 25, 31, 35, 37, 42, 51, 59, 65, 66, 67, 68, 69, 78, 83, 85, 92, 99, 100, 102, 103, 105, 111, 121, 135, 136, 155, 164, 172, 174, 204, 206, 209, 211, 216, 233, 236, 238, 240, 249, 251, 252, 258, 262, 266, 298, 301, 302, 306, 310, 312, 329, 336, 342, 347, 355, 365, 368, 374, 375, 377, 397, 411, 412, 418, 430, 434, 436, 439, 440, 449, 453, 457, 459, 461, 463, 466, 468, 469, 475, 476, 482, 483, 485, 492, 501, 513, 514, 533, 539, 543, 562, 570, 572, 576, 579, 581, ...], 'Food &amp;  Drug Stores': [16, 18, 52, 87, 93, 179, 549, 552, 600, 667, 839, 941], 'Food, Beverages &amp; Tobacco': [44, 47, 79, 86, 95, 107, 113, 116, 153, 181, 215, 225, 274, 320, 322, 357, 361, 378, 382, 385, 417, 445, 477, 480, 511, 538, 575, 611, 628, 633, 683, 694, 717, 734, 759, 900, 937], 'Health Care': [4, 6, 24, 28, 36, 48, 55, 56, 60, 62, 72, 77, 109, 110, 115, 128, 129, 144, 146, 151, 159, 161, 169, 178, 197, 223, 239, 244, 250, 267, 282, 285, 303, 327, 360, 366, 389, 415, 472, 474, 503, 506, 518, 542, 555, 560, 602, 605, 655, 669, 673, 718, 724, 742, 753, 754, 782, 795, 830, 845, 915, 921, 925, 935, 936, 939, 956, 960, 994, 996, 998], 'Hotels, Restaurants &amp; Leisure': [126, 130, 131, 226, 279, 323, 395, 396, 446, 471, 478, 535, 548, 556, 583, 713, 714, 721, 741, 775, 817, 851, 891, 903, 965, 984], 'Household Products': [41, 162, 183, 195, 227, 257, 314, 370, 372, 421, 467, 484, 508, 512, 532, 608, 622, 727, 778, 794, 821, 875, 881, 882, 893, 912, 946, 967], 'Industrials': [17, 64, 76, 96, 101, 139, 148, 154, 177, 203, 255, 292, 341, 346, 359, 413, 419, 444, 546, 571, 601, 616, 619, 620, 626, 627, 631, 634, 664, 687, 730, 731, 750, 776, 803, 813, 827, 850, 853, 854, 857, 864, 878, 887, 938, 943, 951, 966, 981], 'Materials': [123, 150, 193, 245, 261, 276, 304, 311, 337, 393, 398, 399, 403, 409, 426, 435, 441, 455, 460, 516, 522, 524, 564, 594, 595, 596, 606, 609, 614, 624, 641, 662, 663, 685, 695, 707, 729, 756, 781, 786, 833, 837, 945, 957, 974], 'Media': [54, 97, 108, 196, 220, 289, 349, 376, 405, 408, 451, 592, 645, 650, 654, 710, 715, 728, 735, 767, 785, 819, 847, 961, 993], 'Motor Vehicles &amp; Parts': [9, 10, 147, 186, 259, 288, 300, 319, 391, 392, 448, 643, 699, 716, 758, 886, 889, 920, 940], 'Retailing': [0, 7, 14, 22, 38, 39, 71, 84, 119, 122, 133, 137, 138, 156, 171, 173, 180, 182, 208, 230, 234, 247, 271, 272, 277, 278, 280, 287, 293, 294, 297, 316, 321, 328, 332, 334, 339, 362, 390, 422, 424, 433, 438, 458, 464, 470, 504, 507, 509, 545, 547, 580, 589, 610, 612, 621, 644, 665, 680, 698, 732, 745, 746, 770, 777, 792, 822, 846, 855, 856, 858, 880, 909, 926, 971, 989, 992], 'Technology': [3, 21, 29, 33, 34, 45, 57, 61, 75, 81, 106, 132, 143, 149, 157, 158, 188, 191, 194, 200, 228, 260, 284, 290, 291, 305, 308, 353, 373, 388, 400, 402, 410, 416, 431, 442, 481, 491, 494, 505, 515, 519, 523, 525, 536, 544, 550, 551, 553, 557, 558, 573, 578, 585, 586, 597, 636, 646, 656, 666, 674, 696, 697, 703, 709, 726, 752, 755, 763, 769, 780, 783, 787, 788, 797, 799, 807, 823, 824, 828, 834, 842, 843, 849, 862, 868, 871, 874, 876, 892, 897, 902, 919, 924, 927, 931, 944, 948, 969, 970, ...], 'Telecommunications': [8, 15, 32, 73, 165, 202, 324, 473, 520, 907], 'Transportation': [43, 49, 70, 74, 80, 140, 141, 185, 192, 264, 283, 354, 386, 394, 401, 407, 487, 495, 530, 531, 566, 598, 632, 637, 675, 688, 706, 762, 793, 801, 814, 848, 904, 906, 914, 918, 928, 933, 947, 968], 'Wholesalers': [5, 11, 13, 53, 82, 112, 120, 127, 168, 170, 176, 237, 246, 286, 299, 317, 318, 330, 345, 348, 350, 356, 369, 425, 429, 489, 521, 561, 565, 568, 574, 642, 652, 670, 684, 748, 757, 773, 800, 809, 870, 910, 942, 995]}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>fortune.loc[<span class="dv">26</span>, <span class="st">"Sector"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'Aerospace &amp; Defense'</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看每个分组的第一行</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>sectors.first()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Aerospace &amp; Defense</td>
<td>Boeing</td>
<td>93392.0</td>
<td>8197.0</td>
<td>140800</td>
<td>Aerospace and Defense</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apparel</td>
<td>Nike</td>
<td>34350.0</td>
<td>4240.0</td>
<td>74400</td>
<td>Apparel</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Business Services</td>
<td>ManpowerGroup</td>
<td>21034.0</td>
<td>545.4</td>
<td>29000</td>
<td>Temporary Help</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Chemicals</td>
<td>DowDuPont</td>
<td>62683.0</td>
<td>1460.0</td>
<td>98000</td>
<td>Chemicals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Energy</td>
<td>Exxon Mobil</td>
<td>244363.0</td>
<td>19710.0</td>
<td>71200</td>
<td>Petroleum Refining</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Engineering &amp; Construction</td>
<td>Fluor</td>
<td>19521.0</td>
<td>191.4</td>
<td>56706</td>
<td>Engineering, Construction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Financials</td>
<td>Berkshire Hathaway</td>
<td>242137.0</td>
<td>44940.0</td>
<td>377000</td>
<td>Insurance: Property and Casualty (Stock)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Food &amp; Drug Stores</td>
<td>Kroger</td>
<td>122662.0</td>
<td>1907.0</td>
<td>449000</td>
<td>Food and Drug Stores</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Food, Beverages &amp; Tobacco</td>
<td>PepsiCo</td>
<td>63525.0</td>
<td>4857.0</td>
<td>263000</td>
<td>Food Consumer Products</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Health Care</td>
<td>UnitedHealth Group</td>
<td>201159.0</td>
<td>10558.0</td>
<td>260000</td>
<td>Health Care: Insurance and Managed Care</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Hotels, Restaurants &amp; Leisure</td>
<td>Marriott International</td>
<td>22894.0</td>
<td>1372.0</td>
<td>177000</td>
<td>Hotels, Casinos, Resorts</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Household Products</td>
<td>Procter &amp; Gamble</td>
<td>66217.0</td>
<td>15326.0</td>
<td>95000</td>
<td>Household and Personal Products</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Industrials</td>
<td>General Electric</td>
<td>122274.0</td>
<td>-5786.0</td>
<td>313000</td>
<td>Industrial Machinery</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Materials</td>
<td>International Paper</td>
<td>23302.0</td>
<td>2144.0</td>
<td>56000</td>
<td>Packaging, Containers</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Media</td>
<td>Disney</td>
<td>55137.0</td>
<td>8980.0</td>
<td>199000</td>
<td>Entertainment</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Motor Vehicles &amp; Parts</td>
<td>General Motors</td>
<td>157311.0</td>
<td>-3864.0</td>
<td>180000</td>
<td>Motor Vehicles and Parts</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Retailing</td>
<td>Walmart</td>
<td>500343.0</td>
<td>9862.0</td>
<td>2300000</td>
<td>General Merchandisers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Technology</td>
<td>Apple</td>
<td>229234.0</td>
<td>48351.0</td>
<td>123000</td>
<td>Computers, Office Equipment</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Telecommunications</td>
<td>AT&amp;T</td>
<td>160546.0</td>
<td>29450.0</td>
<td>254000</td>
<td>Telecommunications</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Transportation</td>
<td>UPS</td>
<td>65872.0</td>
<td>4910.0</td>
<td>346415</td>
<td>Mail, Package, and Freight Delivery</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Wholesalers</td>
<td>McKesson</td>
<td>198533.0</td>
<td>5070.0</td>
<td>64500</td>
<td>Wholesalers: Health Care</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sectors.last()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Aerospace &amp; Defense</td>
<td>Aerojet Rocketdyne Holdings</td>
<td>1877.0</td>
<td>-9.2</td>
<td>5157</td>
<td>Aerospace and Defense</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apparel</td>
<td>Wolverine World Wide</td>
<td>2350.0</td>
<td>0.3</td>
<td>3700</td>
<td>Apparel</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Business Services</td>
<td>CoreLogic</td>
<td>1851.0</td>
<td>152.2</td>
<td>5900</td>
<td>Financial Data Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Chemicals</td>
<td>Stepan</td>
<td>1925.0</td>
<td>91.6</td>
<td>2096</td>
<td>Chemicals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Energy</td>
<td>Superior Energy Services</td>
<td>1874.0</td>
<td>-205.9</td>
<td>6400</td>
<td>Oil and Gas Equipment, Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Engineering &amp; Construction</td>
<td>TopBuild</td>
<td>1906.0</td>
<td>158.1</td>
<td>8400</td>
<td>Engineering, Construction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Financials</td>
<td>HCP</td>
<td>1848.0</td>
<td>414.2</td>
<td>190</td>
<td>Real estate</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Food &amp; Drug Stores</td>
<td>Freds</td>
<td>2064.0</td>
<td>-140.3</td>
<td>7324</td>
<td>Food and Drug Stores</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Food, Beverages &amp; Tobacco</td>
<td>Universal</td>
<td>2071.0</td>
<td>106.3</td>
<td>24000</td>
<td>Tobacco</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Health Care</td>
<td>Ensign Group</td>
<td>1849.0</td>
<td>40.5</td>
<td>21301</td>
<td>Health Care: Medical Facilities</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Hotels, Restaurants &amp; Leisure</td>
<td>Vail Resorts</td>
<td>1907.0</td>
<td>210.6</td>
<td>20150</td>
<td>Hotels, Casinos, Resorts</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Household Products</td>
<td>ACCO Brands</td>
<td>1949.0</td>
<td>131.7</td>
<td>6620</td>
<td>Home Equipment, Furnishings</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Industrials</td>
<td>Rexnord</td>
<td>1918.0</td>
<td>74.1</td>
<td>8000</td>
<td>Industrial Machinery</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Materials</td>
<td>Summit Materials</td>
<td>1933.0</td>
<td>121.8</td>
<td>6000</td>
<td>Building Materials, Glass</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Media</td>
<td>Tribune Media</td>
<td>1867.0</td>
<td>194.1</td>
<td>6000</td>
<td>Entertainment</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Motor Vehicles &amp; Parts</td>
<td>Tower International</td>
<td>2066.0</td>
<td>47.6</td>
<td>7600</td>
<td>Motor Vehicles and Parts</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Retailing</td>
<td>Childrens Place</td>
<td>1870.0</td>
<td>84.7</td>
<td>9800</td>
<td>Specialty Retailers: Apparel</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Technology</td>
<td>VeriFone Systems</td>
<td>1871.0</td>
<td>-173.8</td>
<td>5600</td>
<td>Financial Data Services</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Telecommunications</td>
<td>Zayo Group Holdings</td>
<td>2200.0</td>
<td>85.7</td>
<td>3794</td>
<td>Telecommunications</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Transportation</td>
<td>Echo Global Logistics</td>
<td>1943.0</td>
<td>12.6</td>
<td>2453</td>
<td>Transportation and Logistics</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Wholesalers</td>
<td>SiteOne Landscape Supply</td>
<td>1862.0</td>
<td>54.6</td>
<td>3664</td>
<td>Wholesalers: Diversified</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取任意一行的数据</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>sectors.nth(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>Home Depot</td>
<td>100904.0</td>
<td>8630.0</td>
<td>413000</td>
<td>Retailing</td>
<td>Specialty Retailers: Other</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>Bank of America Corp.</td>
<td>100264.0</td>
<td>18232.0</td>
<td>209376</td>
<td>Financials</td>
<td>Commercial Banks</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>Anthem</td>
<td>90040.0</td>
<td>3842.8</td>
<td>56000</td>
<td>Health Care</td>
<td>Health Care: Insurance and Managed Care</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>Valero Energy</td>
<td>88407.0</td>
<td>4065.0</td>
<td>10015</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">33</td>
<td>IBM</td>
<td>79139.0</td>
<td>5753.0</td>
<td>397800</td>
<td>Technology</td>
<td>Information Technology Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">53</td>
<td>Sysco</td>
<td>55371.0</td>
<td>1142.5</td>
<td>66500</td>
<td>Wholesalers</td>
<td>Wholesalers: Food and Grocery</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">73</td>
<td>Charter Communications</td>
<td>41581.0</td>
<td>9895.0</td>
<td>94800</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">74</td>
<td>Delta Air Lines</td>
<td>41244.0</td>
<td>3577.0</td>
<td>86564</td>
<td>Transportation</td>
<td>Airlines</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">86</td>
<td>Coca-Cola</td>
<td>35410.0</td>
<td>1248.0</td>
<td>61800</td>
<td>Food, Beverages &amp; Tobacco</td>
<td>Beverages</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">87</td>
<td>Publix Super Markets</td>
<td>34837.0</td>
<td>2291.9</td>
<td>193000</td>
<td>Food &amp; Drug Stores</td>
<td>Food and Drug Stores</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">96</td>
<td>3M</td>
<td>31657.0</td>
<td>4858.0</td>
<td>91536</td>
<td>Industrials</td>
<td>Miscellaneous</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">98</td>
<td>General Dynamics</td>
<td>30973.0</td>
<td>2912.0</td>
<td>98600</td>
<td>Aerospace &amp; Defense</td>
<td>Aerospace and Defense</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">186</td>
<td>Goodyear Tire &amp; Rubber</td>
<td>15377.0</td>
<td>346.0</td>
<td>64000</td>
<td>Motor Vehicles &amp; Parts</td>
<td>Motor Vehicles and Parts</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">195</td>
<td>Newell Brands</td>
<td>14742.0</td>
<td>2748.8</td>
<td>49000</td>
<td>Household Products</td>
<td>Home Equipment, Furnishings</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">196</td>
<td>CBS</td>
<td>14710.0</td>
<td>357.0</td>
<td>14715</td>
<td>Media</td>
<td>Entertainment</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">198</td>
<td>Monsanto</td>
<td>14640.0</td>
<td>2260.0</td>
<td>21900</td>
<td>Chemicals</td>
<td>Chemicals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">199</td>
<td>Aramark</td>
<td>14604.0</td>
<td>373.9</td>
<td>215000</td>
<td>Business Services</td>
<td>Diversified Outsourcing Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">226</td>
<td>Las Vegas Sands</td>
<td>12882.0</td>
<td>2806.0</td>
<td>50500</td>
<td>Hotels, Restaurants &amp; Leisure</td>
<td>Hotels, Casinos, Resorts</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">229</td>
<td>Lennar</td>
<td>12646.0</td>
<td>810.5</td>
<td>9111</td>
<td>Engineering &amp; Construction</td>
<td>Homebuilders</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">245</td>
<td>United States Steel</td>
<td>12250.0</td>
<td>387.0</td>
<td>29200</td>
<td>Materials</td>
<td>Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">420</td>
<td>Ralph Lauren</td>
<td>6653.0</td>
<td>-99.3</td>
<td>18250</td>
<td>Apparel</td>
<td>Apparel</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>fortune[fortune.Sector <span class="op">==</span> <span class="st">"Aerospace &amp; Defense"</span>].iloc[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Company           General Dynamics
Revenues                   30973.0
Profits                     2912.0
Employees                    98600
Sector         Aerospace &amp; Defense
Industry     Aerospace and Defense
Name: 98, dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取每个分区的前两行</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>sectors.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Walmart</td>
<td>500343.0</td>
<td>9862.0</td>
<td>2300000</td>
<td>Retailing</td>
<td>General Merchandisers</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Exxon Mobil</td>
<td>244363.0</td>
<td>19710.0</td>
<td>71200</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Berkshire Hathaway</td>
<td>242137.0</td>
<td>44940.0</td>
<td>377000</td>
<td>Financials</td>
<td>Insurance: Property and Casualty (Stock)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Apple</td>
<td>229234.0</td>
<td>48351.0</td>
<td>123000</td>
<td>Technology</td>
<td>Computers, Office Equipment</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>UnitedHealth Group</td>
<td>201159.0</td>
<td>10558.0</td>
<td>260000</td>
<td>Health Care</td>
<td>Health Care: Insurance and Managed Care</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>McKesson</td>
<td>198533.0</td>
<td>5070.0</td>
<td>64500</td>
<td>Wholesalers</td>
<td>Wholesalers: Health Care</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>CVS Health</td>
<td>184765.0</td>
<td>6622.0</td>
<td>203000</td>
<td>Health Care</td>
<td>Health Care: Pharmacy and Other Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Amazon.com</td>
<td>177866.0</td>
<td>3033.0</td>
<td>566000</td>
<td>Retailing</td>
<td>Internet Services and Retailing</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>AT&amp;T</td>
<td>160546.0</td>
<td>29450.0</td>
<td>254000</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>General Motors</td>
<td>157311.0</td>
<td>-3864.0</td>
<td>180000</td>
<td>Motor Vehicles &amp; Parts</td>
<td>Motor Vehicles and Parts</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Ford Motor</td>
<td>156776.0</td>
<td>7602.0</td>
<td>202000</td>
<td>Motor Vehicles &amp; Parts</td>
<td>Motor Vehicles and Parts</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>AmerisourceBergen</td>
<td>153144.0</td>
<td>364.5</td>
<td>19500</td>
<td>Wholesalers</td>
<td>Wholesalers: Health Care</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Chevron</td>
<td>134533.0</td>
<td>9195.0</td>
<td>51900</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Verizon</td>
<td>126034.0</td>
<td>30101.0</td>
<td>155400</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Kroger</td>
<td>122662.0</td>
<td>1907.0</td>
<td>449000</td>
<td>Food &amp; Drug Stores</td>
<td>Food and Drug Stores</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>General Electric</td>
<td>122274.0</td>
<td>-5786.0</td>
<td>313000</td>
<td>Industrials</td>
<td>Industrial Machinery</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Walgreens Boots Alliance</td>
<td>118214.0</td>
<td>4078.0</td>
<td>290000</td>
<td>Food &amp; Drug Stores</td>
<td>Food and Drug Stores</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>JPMorgan Chase</td>
<td>113899.0</td>
<td>24441.0</td>
<td>252539</td>
<td>Financials</td>
<td>Commercial Banks</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">21</td>
<td>Alphabet</td>
<td>110855.0</td>
<td>12662.0</td>
<td>80110</td>
<td>Technology</td>
<td>Internet Services and Retailing</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">26</td>
<td>Boeing</td>
<td>93392.0</td>
<td>8197.0</td>
<td>140800</td>
<td>Aerospace &amp; Defense</td>
<td>Aerospace and Defense</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41</td>
<td>Procter &amp; Gamble</td>
<td>66217.0</td>
<td>15326.0</td>
<td>95000</td>
<td>Household Products</td>
<td>Household and Personal Products</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43</td>
<td>UPS</td>
<td>65872.0</td>
<td>4910.0</td>
<td>346415</td>
<td>Transportation</td>
<td>Mail, Package, and Freight Delivery</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">44</td>
<td>PepsiCo</td>
<td>63525.0</td>
<td>4857.0</td>
<td>263000</td>
<td>Food, Beverages &amp; Tobacco</td>
<td>Food Consumer Products</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">46</td>
<td>DowDuPont</td>
<td>62683.0</td>
<td>1460.0</td>
<td>98000</td>
<td>Chemicals</td>
<td>Chemicals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47</td>
<td>Archer Daniels Midland</td>
<td>60828.0</td>
<td>1595.0</td>
<td>31300</td>
<td>Food, Beverages &amp; Tobacco</td>
<td>Food Production</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">49</td>
<td>FedEx</td>
<td>60319.0</td>
<td>2997.0</td>
<td>357000</td>
<td>Transportation</td>
<td>Mail, Package, and Freight Delivery</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50</td>
<td>United Technologies</td>
<td>59837.0</td>
<td>4552.0</td>
<td>204700</td>
<td>Aerospace &amp; Defense</td>
<td>Aerospace and Defense</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">54</td>
<td>Disney</td>
<td>55137.0</td>
<td>8980.0</td>
<td>199000</td>
<td>Media</td>
<td>Entertainment</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>Caterpillar</td>
<td>45462.0</td>
<td>754.0</td>
<td>98400</td>
<td>Industrials</td>
<td>Construction and Farm Machinery</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">88</td>
<td>Nike</td>
<td>34350.0</td>
<td>4240.0</td>
<td>74400</td>
<td>Apparel</td>
<td>Apparel</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>Time Warner</td>
<td>31271.0</td>
<td>5247.0</td>
<td>26000</td>
<td>Media</td>
<td>Entertainment</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">123</td>
<td>International Paper</td>
<td>23302.0</td>
<td>2144.0</td>
<td>56000</td>
<td>Materials</td>
<td>Packaging, Containers</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">126</td>
<td>Marriott International</td>
<td>22894.0</td>
<td>1372.0</td>
<td>177000</td>
<td>Hotels, Restaurants &amp; Leisure</td>
<td>Hotels, Casinos, Resorts</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">130</td>
<td>McDonalds</td>
<td>22820.0</td>
<td>5192.3</td>
<td>235000</td>
<td>Hotels, Restaurants &amp; Leisure</td>
<td>Food Services</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">142</td>
<td>ManpowerGroup</td>
<td>21034.0</td>
<td>545.4</td>
<td>29000</td>
<td>Business Services</td>
<td>Temporary Help</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">150</td>
<td>Nucor</td>
<td>20252.0</td>
<td>1318.7</td>
<td>25100</td>
<td>Materials</td>
<td>Metals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">152</td>
<td>Fluor</td>
<td>19521.0</td>
<td>191.4</td>
<td>56706</td>
<td>Engineering &amp; Construction</td>
<td>Engineering, Construction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">160</td>
<td>Visa</td>
<td>18358.0</td>
<td>6699.0</td>
<td>15000</td>
<td>Business Services</td>
<td>Financial Data Services</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">162</td>
<td>Kimberly-Clark</td>
<td>18259.0</td>
<td>2278.0</td>
<td>42000</td>
<td>Household Products</td>
<td>Household and Personal Products</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">163</td>
<td>AECOM</td>
<td>18203.0</td>
<td>339.4</td>
<td>87000</td>
<td>Engineering &amp; Construction</td>
<td>Engineering, Construction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">189</td>
<td>Sherwin-Williams</td>
<td>14984.0</td>
<td>1772.3</td>
<td>52695</td>
<td>Chemicals</td>
<td>Chemicals</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">241</td>
<td>VF</td>
<td>12400.0</td>
<td>614.9</td>
<td>69000</td>
<td>Apparel</td>
<td>Apparel</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>sectors.tail(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">473</td>
<td>Windstream Holdings</td>
<td>5853.0</td>
<td>-2116.6</td>
<td>12979</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">520</td>
<td>Telephone &amp; Data Systems</td>
<td>5044.0</td>
<td>153.0</td>
<td>9900</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">667</td>
<td>Weis Markets</td>
<td>3467.0</td>
<td>98.4</td>
<td>23000</td>
<td>Food &amp; Drug Stores</td>
<td>Food and Drug Stores</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">759</td>
<td>Hain Celestial Group</td>
<td>2853.0</td>
<td>67.4</td>
<td>7825</td>
<td>Food, Beverages &amp; Tobacco</td>
<td>Food Consumer Products</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">774</td>
<td>Fossil Group</td>
<td>2788.0</td>
<td>-478.2</td>
<td>12300</td>
<td>Apparel</td>
<td>Apparel</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">995</td>
<td>SiteOne Landscape Supply</td>
<td>1862.0</td>
<td>54.6</td>
<td>3664</td>
<td>Wholesalers</td>
<td>Wholesalers: Diversified</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">996</td>
<td>Charles River Laboratories Intl</td>
<td>1858.0</td>
<td>123.4</td>
<td>11800</td>
<td>Health Care</td>
<td>Health Care: Pharmacy and Other Services</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">997</td>
<td>CoreLogic</td>
<td>1851.0</td>
<td>152.2</td>
<td>5900</td>
<td>Business Services</td>
<td>Financial Data Services</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">998</td>
<td>Ensign Group</td>
<td>1849.0</td>
<td>40.5</td>
<td>21301</td>
<td>Health Care</td>
<td>Health Care: Medical Facilities</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999</td>
<td>HCP</td>
<td>1848.0</td>
<td>414.2</td>
<td>190</td>
<td>Financials</td>
<td>Real estate</td>
</tr>
</tbody>
</table>

<p>63 rows × 6 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sectors.get_group(<span class="st">"Energy"</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>Exxon Mobil</td>
<td>244363.0</td>
<td>19710.0</td>
<td>71200</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">12</td>
<td>Chevron</td>
<td>134533.0</td>
<td>9195.0</td>
<td>51900</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27</td>
<td>Phillips 66</td>
<td>91568.0</td>
<td>5106.0</td>
<td>14600</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>Valero Energy</td>
<td>88407.0</td>
<td>4065.0</td>
<td>10015</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>Marathon Petroleum</td>
<td>67610.0</td>
<td>3432.0</td>
<td>43800</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="aggregate-operations" class="level2">
<h2 class="anchored" data-anchor-id="aggregate-operations">9.4 Aggregate operations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>sectors.<span class="bu">sum</span>().head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Aerospace &amp; Defense</td>
<td>BoeingUnited TechnologiesLockheed MartinGenera...</td>
<td>383835.0</td>
<td>26733.5</td>
<td>1010124</td>
<td>Aerospace and DefenseAerospace and DefenseAero...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apparel</td>
<td>NikeVFPVHRalph LaurenHanesbrandsUnder ArmourLe...</td>
<td>101157.3</td>
<td>6350.7</td>
<td>355699</td>
<td>ApparelApparelApparelApparelApparelApparelAppa...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Business Services</td>
<td>ManpowerGroupVisaOmnicom GroupAramarkWaste Man...</td>
<td>316090.0</td>
<td>37179.2</td>
<td>1593999</td>
<td>Temporary HelpFinancial Data ServicesAdvertisi...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Chemicals</td>
<td>DowDuPontSherwin-WilliamsPPG IndustriesMonsant...</td>
<td>251151.0</td>
<td>20475.0</td>
<td>474020</td>
<td>ChemicalsChemicalsChemicalsChemicalsChemicalsC...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Energy</td>
<td>Exxon MobilChevronPhillips 66Valero EnergyMara...</td>
<td>1543507.2</td>
<td>85369.6</td>
<td>981207</td>
<td>Petroleum RefiningPetroleum RefiningPetroleum ...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sectors.get_group(<span class="st">"Aerospace &amp; Defense"</span>).Revenues.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>383835.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>sectors.Revenues</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>sectors.Revenues.<span class="bu">sum</span>().head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Sector
Aerospace &amp; Defense     383835.0
Apparel                 101157.3
Business Services       316090.0
Chemicals               251151.0
Energy                 1543507.2
Name: Revenues, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>sectors.Profits.<span class="bu">max</span>().head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Sector
Aerospace &amp; Defense     8197.0
Apparel                 4240.0
Business Services       6699.0
Chemicals               3000.4
Energy                 19710.0
Name: Profits, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>aggregations <span class="op">=</span> {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Revenues"</span>: <span class="st">"min"</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Profits"</span>: <span class="st">"max"</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Employees"</span>: <span class="st">"mean"</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>sectors.agg(aggregations).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Aerospace &amp; Defense</td>
<td>1877.0</td>
<td>8197.0</td>
<td>40404.960000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apparel</td>
<td>2350.0</td>
<td>4240.0</td>
<td>25407.071429</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Business Services</td>
<td>1851.0</td>
<td>6699.0</td>
<td>30075.452830</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Chemicals</td>
<td>1925.0</td>
<td>3000.4</td>
<td>14364.242424</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Energy</td>
<td>1874.0</td>
<td>19710.0</td>
<td>9170.158879</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="applying-a-custom-operation-to-all-groups" class="level2">
<h2 class="anchored" data-anchor-id="applying-a-custom-operation-to-all-groups">9.5 Applying a custom operation to all groups</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>fortune.nlargest(n<span class="op">=</span><span class="dv">5</span>, columns<span class="op">=</span><span class="st">"Profits"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>Apple</td>
<td>229234.0</td>
<td>48351.0</td>
<td>123000</td>
<td>Technology</td>
<td>Computers, Office Equipment</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>Berkshire Hathaway</td>
<td>242137.0</td>
<td>44940.0</td>
<td>377000</td>
<td>Financials</td>
<td>Insurance: Property and Casualty (Stock)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>Verizon</td>
<td>126034.0</td>
<td>30101.0</td>
<td>155400</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>AT&amp;T</td>
<td>160546.0</td>
<td>29450.0</td>
<td>254000</td>
<td>Telecommunications</td>
<td>Telecommunications</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>JPMorgan Chase</td>
<td>113899.0</td>
<td>24441.0</td>
<td>252539</td>
<td>Financials</td>
<td>Commercial Banks</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_largest_row(df):</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df.nlargest(<span class="dv">1</span>, <span class="st">"Revenues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>sectors.<span class="bu">apply</span>(get_largest_row).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Aerospace &amp; Defense</td>
<td data-quarto-table-cell-role="th">26</td>
<td>Boeing</td>
<td>93392.0</td>
<td>8197.0</td>
<td>140800</td>
<td>Aerospace &amp; Defense</td>
<td>Aerospace and Defense</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apparel</td>
<td data-quarto-table-cell-role="th">88</td>
<td>Nike</td>
<td>34350.0</td>
<td>4240.0</td>
<td>74400</td>
<td>Apparel</td>
<td>Apparel</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Business Services</td>
<td data-quarto-table-cell-role="th">142</td>
<td>ManpowerGroup</td>
<td>21034.0</td>
<td>545.4</td>
<td>29000</td>
<td>Business Services</td>
<td>Temporary Help</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Chemicals</td>
<td data-quarto-table-cell-role="th">46</td>
<td>DowDuPont</td>
<td>62683.0</td>
<td>1460.0</td>
<td>98000</td>
<td>Chemicals</td>
<td>Chemicals</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Energy</td>
<td data-quarto-table-cell-role="th">1</td>
<td>Exxon Mobil</td>
<td>244363.0</td>
<td>19710.0</td>
<td>71200</td>
<td>Energy</td>
<td>Petroleum Refining</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="grouping-by-multiple-columns" class="level2">
<h2 class="anchored" data-anchor-id="grouping-by-multiple-columns">9.6 Grouping by multiple columns</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>sector_and_industry <span class="op">=</span> fortune.groupby(by <span class="op">=</span> [<span class="st">"Sector"</span>, <span class="st">"Industry"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>sector_and_industry.size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Sector               Industry                                     
Aerospace &amp; Defense  Aerospace and Defense                            25
Apparel              Apparel                                          14
Business Services    Advertising, marketing                            2
                     Diversified Outsourcing Services                 14
                     Education                                         2
                                                                      ..
Transportation       Trucking, Truck Leasing                          11
Wholesalers          Wholesalers: Diversified                         24
                     Wholesalers: Electronics and Office Equipment     8
                     Wholesalers: Food and Grocery                     6
                     Wholesalers: Health Care                          6
Length: 82, dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>sector_and_industry.get_group((<span class="st">"Business Services"</span>, <span class="st">"Education"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">567</td>
<td>Laureate Education</td>
<td>4378.0</td>
<td>91.5</td>
<td>54500</td>
<td>Business Services</td>
<td>Education</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">810</td>
<td>Graham Holdings</td>
<td>2592.0</td>
<td>302.0</td>
<td>16153</td>
<td>Business Services</td>
<td>Education</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>sector_and_industry.<span class="bu">sum</span>().head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Company</th>
<th data-quarto-table-cell-role="th">Revenues</th>
<th data-quarto-table-cell-role="th">Profits</th>
<th data-quarto-table-cell-role="th">Employees</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Sector</th>
<th data-quarto-table-cell-role="th">Industry</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Aerospace &amp; Defense</td>
<td data-quarto-table-cell-role="th">Aerospace and Defense</td>
<td>BoeingUnited TechnologiesLockheed MartinGenera...</td>
<td>383835.0</td>
<td>26733.5</td>
<td>1010124</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Apparel</td>
<td data-quarto-table-cell-role="th">Apparel</td>
<td>NikeVFPVHRalph LaurenHanesbrandsUnder ArmourLe...</td>
<td>101157.3</td>
<td>6350.7</td>
<td>355699</td>
</tr>
<tr class="odd">
<td rowspan="3" data-quarto-table-cell-role="th" data-valign="top">Business Services</td>
<td data-quarto-table-cell-role="th">Advertising, marketing</td>
<td>Omnicom GroupInterpublic Group</td>
<td>23156.0</td>
<td>1667.4</td>
<td>127500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Diversified Outsourcing Services</td>
<td>AramarkADPConduentABM IndustriesCintasADTIron ...</td>
<td>74175.0</td>
<td>5043.7</td>
<td>858600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Education</td>
<td>Laureate EducationGraham Holdings</td>
<td>6970.0</td>
<td>393.5</td>
<td>70653</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sector_and_industry[<span class="st">"Revenues"</span>].mean().head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Sector               Industry                        
Aerospace &amp; Defense  Aerospace and Defense               15353.400000
Apparel              Apparel                              7225.521429
Business Services    Advertising, marketing              11578.000000
                     Diversified Outsourcing Services     5298.214286
                     Education                            3485.000000
Name: Revenues, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="coding-challenge" class="level2">
<h2 class="anchored" data-anchor-id="coding-challenge">9.7 Coding challenge</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>cereals <span class="op">=</span> pd.read_csv(BASE <span class="op">/</span> <span class="st">"pandas-in-action/cereals.csv"</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>cereals.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Manufacturer</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Calories</th>
<th data-quarto-table-cell-role="th">Fiber</th>
<th data-quarto-table-cell-role="th">Sugars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100% Bran</td>
<td>Nabisco</td>
<td>Cold</td>
<td>70</td>
<td>10.0</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>100% Natural Bran</td>
<td>Quaker Oats</td>
<td>Cold</td>
<td>120</td>
<td>2.0</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>All-Bran</td>
<td>Kellogg's</td>
<td>Cold</td>
<td>70</td>
<td>9.0</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>All-Bran with Extra Fiber</td>
<td>Kellogg's</td>
<td>Cold</td>
<td>50</td>
<td>14.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Almond Delight</td>
<td>Ralston Purina</td>
<td>Cold</td>
<td>110</td>
<td>1.0</td>
<td>8</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>manufacturer <span class="op">=</span> cereals.groupby(<span class="st">"Manufacturer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(manufacturer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>manufacturer.size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Manufacturer
American Home Food Products     1
General Mills                  22
Kellogg's                      23
Nabisco                         6
Post                            9
Quaker Oats                     8
Ralston Purina                  8
dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>manufacturer.get_group(<span class="st">"Nabisco"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Manufacturer</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Calories</th>
<th data-quarto-table-cell-role="th">Fiber</th>
<th data-quarto-table-cell-role="th">Sugars</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100% Bran</td>
<td>Nabisco</td>
<td>Cold</td>
<td>70</td>
<td>10.0</td>
<td>6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20</td>
<td>Cream of Wheat (Quick)</td>
<td>Nabisco</td>
<td>Hot</td>
<td>100</td>
<td>1.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">63</td>
<td>Shredded Wheat</td>
<td>Nabisco</td>
<td>Cold</td>
<td>80</td>
<td>3.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">64</td>
<td>Shredded Wheat 'n'Bran</td>
<td>Nabisco</td>
<td>Cold</td>
<td>90</td>
<td>4.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">65</td>
<td>Shredded Wheat spoon size</td>
<td>Nabisco</td>
<td>Cold</td>
<td>90</td>
<td>3.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">68</td>
<td>Strawberry Fruit Wheats</td>
<td>Nabisco</td>
<td>Cold</td>
<td>90</td>
<td>3.0</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>manufacturer[[<span class="st">'Calories'</span>, <span class="st">'Fiber'</span>, <span class="st">'Sugars'</span>]].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Calories</th>
<th data-quarto-table-cell-role="th">Fiber</th>
<th data-quarto-table-cell-role="th">Sugars</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Manufacturer</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">American Home Food Products</td>
<td>100.000000</td>
<td>0.000000</td>
<td>3.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">General Mills</td>
<td>111.363636</td>
<td>1.272727</td>
<td>7.954545</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Kellogg's</td>
<td>108.695652</td>
<td>2.739130</td>
<td>7.565217</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Nabisco</td>
<td>86.666667</td>
<td>4.000000</td>
<td>1.833333</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Post</td>
<td>108.888889</td>
<td>2.777778</td>
<td>8.777778</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Quaker Oats</td>
<td>95.000000</td>
<td>1.337500</td>
<td>5.250000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ralston Purina</td>
<td>115.000000</td>
<td>1.875000</td>
<td>6.125000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>manufacturer[<span class="st">"Sugars"</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Manufacturer
American Home Food Products     3
General Mills                  14
Kellogg's                      15
Nabisco                         6
Post                           15
Quaker Oats                    12
Ralston Purina                 11
Name: Sugars, dtype: int64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>manufacturer.Fiber.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Manufacturer
American Home Food Products    0.0
General Mills                  0.0
Kellogg's                      0.0
Nabisco                        1.0
Post                           0.0
Quaker Oats                    0.0
Ralston Purina                 0.0
Name: Fiber, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> DataFrame</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> smallest_sugar_row(pd:DataFrame):</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.nsmallest(<span class="dv">1</span>, <span class="st">"Sugars"</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>manufacturer.<span class="bu">apply</span>(smallest_sugar_row).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Manufacturer</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Calories</th>
<th data-quarto-table-cell-role="th">Fiber</th>
<th data-quarto-table-cell-role="th">Sugars</th>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Manufacturer</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">American Home Food Products</td>
<td data-quarto-table-cell-role="th">43</td>
<td>Maypo</td>
<td>American Home Food Products</td>
<td>Hot</td>
<td>100</td>
<td>0.0</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">General Mills</td>
<td data-quarto-table-cell-role="th">11</td>
<td>Cheerios</td>
<td>General Mills</td>
<td>Cold</td>
<td>110</td>
<td>2.0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Kellogg's</td>
<td data-quarto-table-cell-role="th">3</td>
<td>All-Bran with Extra Fiber</td>
<td>Kellogg's</td>
<td>Cold</td>
<td>50</td>
<td>14.0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Nabisco</td>
<td data-quarto-table-cell-role="th">20</td>
<td>Cream of Wheat (Quick)</td>
<td>Nabisco</td>
<td>Hot</td>
<td>100</td>
<td>1.0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Post</td>
<td data-quarto-table-cell-role="th">33</td>
<td>Grape-Nuts</td>
<td>Post</td>
<td>Cold</td>
<td>110</td>
<td>3.0</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>